{"version":3,"sources":["public\\js\\app.js"],"names":["$","ready","prot","window","location","protocol","wuLogo","date","Date","tempUnit","cache","cacheTime","hour","city","timeStamp","temp","conditions","weatherURL","conditionsIcon","attr","on","getData","getCache","sessionStorage","getItem","now","setWeather","getLoc","setCache","data","setItem","JSON","stringify","parse","navigator","geolocation","getCurrentPosition","success","error","position","lat","coords","latitude","lon","longitude","getWeather","current_observation","display_location","full","temp_f","weather","ob_url","icon","text","formatDate","setMood","zzz","apiURL","arguments","request","ajax","url","dataType","handleRequest","jsonp","console","log","getHours","removeClass","addClass","Number","prototype","round","places","Math","convertToCelsius","m","getMonth","d","getDay","y","getFullYear","t","toLocaleTimeString","toLowerCase","test","key","statement","url2","getJSON"],"mappings":"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","file":"app.280f28d9.map","sourceRoot":"..","sourcesContent":["\r\n//Main function starts here\r\n$(\"document\").ready(function(){\r\n  var prot = window.location.protocol; //get connection protocol being used\r\n  var wuLogo = prot + \"//icons.wxug.com/graphics/wu2/logo_130x80.png\"; //logo to display on website. using hack since cannot store image locally\r\n  var date = new Date();  //get current date\r\n  var tempUnit = \"F\";\r\n\r\n  var cache,\r\n  cacheTime,\r\n  hour,\r\n  city,\r\n  timeStamp,\r\n  temp,\r\n  conditions,\r\n  weatherURL,\r\n  conditionsIcon;\r\n\r\n\r\n  $(\"#wu-logo\").attr(\"src\", wuLogo); //hack to set link to http or https to avoid errors\r\n\r\n  //Set handler for weather button\r\n  $(\"#weather\").on(\"click\", function(){\r\n    getData();\r\n  });\r\n\r\n  getData(); //gets the ball rolling\r\n\r\n  /*============================================================================================================\r\n  START OF FUNCITON DECLARATIONS\r\n  ==============================================================================================================*/\r\n\r\n  //getData() : checks cache for weather data, and if not found, gets location and weather data\r\n  function getData(){\r\n\r\n    cache = getCache();\r\n    timeStamp = sessionStorage.getItem('cacheTime');\r\n\r\n    if(cache && (Date.now() - timeStamp) / (1000 * 60) < 1.0){ //to to see if there is a cache\r\n                                                            // and that time since last refresh\r\n      setWeather(cache);                                      // is less than 1 minute\r\n    }\r\n    else{\r\n\r\n    date = new Date();\r\n      getLoc(); //Try to get location from browser - gets app going\r\n    }\r\n  } //end of getData()\r\n\r\n  //setCache(data) : sets the cache on sessionStorage using data from api call\r\n  function setCache(data){\r\n    //set time cache is set in 'cacheTime'\r\n    sessionStorage.setItem('cacheTime', Date.now());\r\n    //set cache\r\n    sessionStorage.setItem('cache', JSON.stringify(data));\r\n  }\r\n\r\n  //getCache(): returns the cache\r\n  function getCache(){\r\n    return JSON.parse(sessionStorage.getItem('cache'));\r\n  }\r\n  //getLoc(): gets the current location and then calls getWeather with location data\r\n  // Note: because geolocation no longer works from non https servers, must use fallback api for geolocation\r\n  function getLoc(){\r\n    navigator.geolocation.getCurrentPosition(success, error);\r\n    function success(position){\r\n      var lat = position.coords.latitude;\r\n      var lon = position.coords.longitude;\r\n      getWeather({lat: lat, lon: lon}); //function to get current weather conditions from Weather Underground using latitude and longitude\r\n    }\r\n    function error( error ){ //if we cannot use browser navigator, then look up service using ip lookup at Weather Underground\r\n      getWeather();\r\n    }\r\n  } //end of getLoc()\r\n\r\n  //setWeather(data) : takes data from api call and sets weather conditions on display\r\n  function setWeather(data){\r\n    city = data.current_observation.display_location.full;\r\n    temp = data.current_observation.temp_f;\r\n    conditions = data.current_observation.weather;\r\n    weatherURL = data.current_observation.ob_url;\r\n    conditionsIcon = prot + \"//icons.wxug.com/i/c/f/\" + data.current_observation.icon + \".gif\";\r\n\r\n    //set up the display using data from api call\r\n    $(\"h1 a\").attr(\"href\", weatherURL);\r\n    $(\"#city\").text(city);\r\n    $(\"#date\").text(formatDate(date));\r\n    $(\"#temp\").text(temp);\r\n    $(\"#conditions\").text(conditions);\r\n    $(\"#condition-icon\").attr(\"src\", conditionsIcon);\r\n\r\n    //Set background color and font color according to sky cover and percipitation\r\n    setMood(data.current_observation.icon, date);\r\n  } // end of setWeather()\r\n\r\n  //function to make api call to Weather Underground\r\n  function getWeather(){\r\n    var zzz = \"2a437a96975257dc\";\r\n    var apiURL = prot + \"//api.wunderground.com/api/\" + zzz + \"/conditions/q/\";\r\n\r\n    //if we recieved some arguments for lat & lon, we use them for the call\r\n    if(arguments[0]){\r\n      apiURL += arguments[0].lat + \",\"+ arguments[0].lon + \".json\";\r\n    }\r\n    else{ /* If not, then use autoip look up service */\r\n     apiURL += \"autoip.json\";\r\n    }\r\n    //ajax call to retrieve weather data using jsonp because of cross-server shenanigans\r\n    // why couldn't WU have enabled CORS?  Why?\r\n    var request = $.ajax({\r\n      url: apiURL,\r\n      dataType: \"jsonp\",\r\n      success: handleRequest,\r\n      jsonp: \"callback\"\r\n\r\n    });\r\n\r\n    //handle request once it is complete\r\n    function handleRequest( data ){\r\n      if( data ){\r\n        setCache(data); //cache data\r\n        setWeather(data); //send weather data to the view\r\n      } //end of if(data)\r\n      else{\r\n        console.log(\"No Data!\"); //This would be bad.\r\n      }\r\n    } //end of handleRequest()\r\n  } //end of getWeather()\r\n\r\n  //Set mood color scheme depending on weather conditions and day/night\r\n  function setMood(conditionsIcon, date){\r\n    hour = date.getHours();\r\n    $(\"#container\").removeClass(); //clear all classes\r\n    if(hour >= 20 || hour <= 4){ //If night time\r\n    $(\"#container\").addClass(\"night\"); //set to night\r\n    switch(conditionsIcon){\r\n      case \"clear\":\r\n      case \"cloudy\":\r\n      case \"fog\":\r\n      case \"hazy\":\r\n      case \"mostlycloudy\":\r\n      case \"partlycloudy\":\r\n      case \"partlysunny\":\r\n        $(\"#container\").addClass(\"clear\");\r\n        break;\r\n      case \"chancerain\":\r\n      case \"chancesleet\":\r\n      case \"sleet\":\r\n      case \"rain\":\r\n        $(\"#container\").addClass(\"rain\");\r\n        break;\r\n      case \"chancetstorms\":\r\n      case \"tstorms\":\r\n        $(\"#container\").addClass(\"lightning\");\r\n        break;\r\n      case \"chanceflurries\":\r\n      case \"chancesnow\":\r\n      case \"flurries\":\r\n      case \"snow\":\r\n        $(\"#container\").addClass(\"snow\");\r\n        break;\r\n      default:\r\n        $(\"#container\").addClass(\"clear\");\r\n    } ////end switch statement with lovely fallthroughs (or not)\r\n    } //end if\r\n    else{\r\n    switch(conditionsIcon){\r\n      case \"clear\":\r\n      case \"partlycloudy\":\r\n      case \"partlysunny\":\r\n         $(\"#container\").addClass(\"day clear\");\r\n        break;\r\n      case \"cloudy\":\r\n      case \"fog\":\r\n      case \"hazy\":\r\n      case \"mostlycloudy\":\r\n        $(\"#container\").addClass(\"day-overcast clear\");\r\n        break;\r\n      case \"chancerain\":\r\n      case \"chancesleet\":\r\n        $(\"#container\").addClass(\"day-overcast rain\");\r\n        break;\r\n      case \"sleet\":\r\n      case \"rain\":\r\n        $(\"#container\").addClass(\"day-stormy rain\");\r\n        break;\r\n      case \"chancetstorms\":\r\n        $(\"#container\").addClass(\"day-overcast lightning\");\r\n        break;\r\n      case \"tstorms\":\r\n        $(\"#container\").addClass(\"day-stormy lightning\");\r\n        break;\r\n      case \"chanceflurries\":\r\n      case \"chancesnow\":\r\n      case \"flurries\":\r\n        $(\"#container\").addClass(\"day-overcast snow\");\r\n        break;\r\n      case \"snow\":\r\n        $(\"#container\").addClass(\"day-stormy snow\");\r\n        break;\r\n      default:\r\n        $(\"#container\").addClass(\"day clear\");\r\n    } //end switch statement with lovely fallthroughs (or not)\r\n    } //end else\r\n  } //end of setMood()\r\n\r\n  //hack to make my decimal places round out when converting between celsius and farenheit\r\n  Number.prototype.round = function(places) {\r\n    return +(Math.round(this + \"e+\" + places)  + \"e-\" + places);\r\n  }\r\n\r\n  //utility function to convert farenheit to celsius\r\n  function convertToCelsius(temp){\r\n    return ((temp - 32) / 1.8).round(1);\r\n  }\r\n\r\n  /*============================================================================================================\r\n    INTERFACE COPONENTS\r\n  ==============================================================================================================*/\r\n  //click handler to convert betwen F and C\r\n  $(\"#measure\").on(\"click\", function(){\r\n    if(temp && tempUnit === \"F\"){\r\n      $(\"#temp\").text(convertToCelsius(temp));\r\n      tempUnit = \"C\";\r\n      $(\"#measure\").text(\" \" + tempUnit);\r\n      }\r\n    else{\r\n      $(\"#temp\").text(temp);\r\n      tempUnit = \"F\";\r\n      $(\"#measure\").text(\" \" + tempUnit);\r\n    }\r\n  });\r\n\r\n  //Utility function for pretty formating of dates\r\n  function formatDate(date){\r\n    var m = date.getMonth();\r\n    var d = date.getDay();\r\n    var y = date.getFullYear();\r\n    //var hour = date.getHours();\r\n    //var minutes = date.getMinutes();\r\n    //var oclock = \"am\";\r\n    var t = date.toLocaleTimeString().toLowerCase();\r\n\r\n    return m + \"-\" + d + \"-\" + y + \" \" + t;\r\n  }\r\n\r\n  function test(key){\r\n    var url = 'https://query.yahooapis.com/v1/public/yql?format=json&q=';\r\n    var statement = 'select * from weather.forecast where woeid=' + key;\r\n    var url2 = url + 'select * from weather.forecast where woeid in (SELECT woeid FROM geo.places WHERE text=\"({42.107413},{-88.021074})\")';\r\n    /*var url = 'https://query.yahooapis.com/v1/public/yql?format=json&q=' +\r\n        statement;*/\r\n\r\n\r\n    $.getJSON(url2, function(data){\r\n      console.log(data);\r\n    });\r\n  }\r\n  test('2459115');\r\n\r\n}); //end of $(\"document\").ready\r\n//# sourceURL=pen.js\r\n"]}